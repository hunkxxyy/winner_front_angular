{"version":3,"file":"ingatlanModify.js","sourceRoot":"","sources":["file:///C:/wamp64/www/ingatlanlotto/winner_front/tmp/broccoli_type_script_compiler-input_base_path-5I6P9bcc.tmp/0/src/app/views/admin/ingatlanok/ingatlanModify.ts"],"names":[],"mappings":"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","sourcesContent":["import {Component, OnInit} from '@angular/core';\nimport {ErrorService} from \"../../../globals/services/error.service\";\nimport {AdminIngatlanHeaderComponent} from \"./header.component\";\nimport {APIService} from \"../../../globals/services/API.service\";\nimport {AuthService} from \"../../../globals/services/auth.service\";\nimport {IngatlanType,ingatlanDeffault} from \"./ingatlanDeffault\";\nimport {MultipartItem} from \"../../../utils/multipart-upload/multipart-item\";\nimport {MultipartUploader} from \"../../../utils/multipart-upload/multipart-uploader\";\nimport {globals} from \"../../../utils/global.constats\";\nimport {ingatlanKepComponent,kepType} from \"./ingatlanKep.component\";\nimport {ActivatedRoute} from '@angular/router';\nconst URL = globals.backendIp + 'api/ingatlan_kepek';\n@Component({\n    moduleId: module.id,\n    selector: 'ingatlan-modify',\n    templateUrl: 'ingatlanModify.html',\n    directives: [AdminIngatlanHeaderComponent, ingatlanKepComponent],\n    styleUrls: ['ingatlan-modify.css'],\n    providers: [APIService]\n})\nexport class IngatlanModifyComponent implements OnInit {\n    ingatlan:ingatlanDeffault;\n    kepek:Array<kepType>;\n    positions:Array<number>;\n    modifying:any;\n    file:File;\n    kep_nev:string;\n    sorsjegydb:number;\n\n    private uploader:MultipartUploader = new MultipartUploader({url: URL});\n    multipartItem:MultipartItem = new MultipartItem(this.uploader);\n\n    onKepfeltoltes($event):void {\n        // console.log('uj file');\n        var inputValue = $event.target;\n        if (null == inputValue || null == inputValue.files[0]) {\n            //  console.debug(\"Input file error.\");\n            return;\n        } else {\n            this.file = inputValue.files[0];\n            // console.debug(\"Input File name: \" + this.file.name + \" type:\" + this.file.size + \" size:\" + this.file.size);\n            this.upload();\n        }\n    }\n\n    onKey(value) {\n        this.kep_nev = value;\n        //  this.file.name=value;\n    }\n\n    upload() {\n\n        if (null == this.file) {\n            console.error(\"home.ts & upload() form invalid.\");\n            return;\n        }\n        if (this.multipartItem == null) {\n            this.multipartItem = new MultipartItem(this.uploader);\n        }\n        if (this.multipartItem.formData == null)\n            this.multipartItem.formData = new FormData();\n\n\n        this.multipartItem.formData.append(\"file\", this.file);\n        this.multipartItem.formData.append(\"name\", this.kep_nev);\n        this.multipartItem.formData.append(\"ingatlan_id\", (this.ingatlan.id)?this.ingatlan.id:1);\n        this.multipartItem.formData.append(\"access_token\", this._AuthService.user.access_token);\n        this.multipartItem.callback = this.uploadCallback;\n        this.multipartItem.upload();\n    }\n\n    uploadCallback:(data) => void;\n\n    constructor(private _ErrorService:ErrorService,\n                private _ApiSrvice:APIService,\n                private _AuthService:AuthService,\n                private _ActivatedRoute:ActivatedRoute ) {\n        this.ingatlan=new ingatlanDeffault;\n        this.uploadCallback = (data) => {\n\n            this.file = null;\n            if (data) {\n                // console.log(data);\n                this.refreshKepek();\n                // console.debug(\"home.ts & uploadCallback() upload file success.\");\n            } else {\n                console.error(\"home.ts & uploadCallback() upload file false.\");\n            }\n        }\n\n    }\n\n;\n    private refreshKepek() {\n        if (this.ingatlan.id > 0) {\n            this._ApiSrvice.getResponseGET('api/ingatlan/' + this.ingatlan.id, '')\n                .subscribe(\n                    data=> {\n\n\n                    this.kepek = data.kepek;\n                    var pos = [];\n                    data.kepek.forEach((obj)=> {\n                        pos.push(obj.pos);\n                    });\n                    this.positions = pos;\n\n\n                },\n                    error=> {\n                })\n        }\n        else {\n            this._ApiSrvice.getResponseGET('api/ingatlan_kepeks/where=ingatlan_id=1&orderBy=pos', '')\n                .subscribe(\n                    data=> {\n\n\n                    this.kepek = data;\n                    var pos = [];\n                    this.kepek.forEach((obj)=> {\n                        pos.push(obj.pos);\n                    });\n                    this.positions = pos;\n\n\n                },\n                    error=> {\n                })\n        }\n\n    }\n\n    onUpdate() {\n        if (this.ingatlan.id) {\n            this._ApiSrvice.getResponsePUT('api/ingatlan/modify/' + this.ingatlan.id, this.ingatlan)\n                .subscribe(\n                    data=> {\n                    if (data.errors)\n                    {\n                        alert(data.errors);\n                    }\n                    else\n                        window.location.replace(\"#/admin/ingatlanok\");\n\n                },\n                    error=> {\n                }\n            )\n\n        }\n        else {\n            this._ApiSrvice.getResponse('api/ingatlan/', this.ingatlan)\n                .subscribe(\n                    data=> {\n                        console.log(data);\n                        if (data.errors)\n                        {\n\n                            alert(data.errors);\n                        }\n                        else{\n                            console.log(data);\n                            this.ingatlan = data.Ingatlan;\n                            //this.refreshKepek();\n                            window.location.replace(\"#/admin/ingatlanok\");\n\n                        }\n\n                },\n                    error=> {\n                }\n            )\n        }\n    }\n\n    onArchivePic($event) {\n        this._ApiSrvice.getResponsePUT('api/ingatlan_kepek/archive/' + $event, {})\n            .subscribe(\n                data=> {\n\n\n                this.kepek = data.kepek;\n                this.refreshKepek();\n\n            },\n                error=> {\n            }\n        )\n    }\n\n    onRefresh($event) {\n        this.refreshKepek();\n    }\n\n    onDelete() {\n        var r = confirm(\"Biztosan törlöd az ingatlant?!\");\n        if (r == true) {\n            this._ApiSrvice.getResponsePUT('api/ingatlan/archive/' + this.ingatlan.id, '')\n                .subscribe(\n                    data=> {\n                    window.location.replace(\"#/admin/ingatlanok\");\n\n\n                },\n                    error=> {\n                })\n        }\n    }\n\n    onModifyIt($event) {\n        this.modifying = $event;\n        //console.log($event);\n        let css = 'selected';\n        if ($event.cssClass == 'selected') css = '';\n        this.kepek.forEach((obj)=> {\n            obj.cssClass = '';\n        });\n\n        $event.cssClass = css;\n\n    }\n\n    sorsjegydbCalculate(ar, sorsjegyar) {\n     //   console.log(ar + ', ' + sorsjegyar);\n        if (ar>0 && sorsjegyar>0)\n        {\n            this.sorsjegydb = Math.ceil(ar / sorsjegyar);\n        } else\n            this.sorsjegydb = 0;\n    }\n\n    ngOnInit() {\n\n\n        let url = this._ActivatedRoute.snapshot.params['id'];\n\n        if (url != 'new') {\n            this._ApiSrvice.getResponseGET('api/ingatlan/' + url, '')\n                .subscribe(\n                    data=> {\n                    var pos = [];\n                    this.ingatlan = data;\n                    this.sorsjegydbCalculate(this.ingatlan.ingatlan_ar,this.ingatlan.sorsjegy_ar);\n                    this.kepek = data.kepek;\n                    data.kepek.forEach((obj)=> {\n                        pos.push(obj.pos);\n                    });\n                    this.positions = pos;\n\n                    //console.log(this.kepek);\n\n\n                },\n                    error=> {\n                })\n        }\n        else {\n            this.refreshKepek();\n        }\n\n    }\n}\n"]}